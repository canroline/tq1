(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/component/audio/goodDetail/goodDetail"],{"0253":function(o,n,t){"use strict";t.r(n);var e=t("656a"),a=t("ed75");for(var i in a)"default"!==i&&function(o){t.d(n,o,function(){return a[o]})}(i);t("f783");var s=t("2877"),d=Object(s["a"])(a["default"],e["a"],e["b"],!1,null,null,null);n["default"]=d.exports},"656a":function(o,n,t){"use strict";var e=function(){var o=this,n=o.$createElement,t=(o._self._c,o.__map(o.goodInfo.goods_img_Arr,function(n,t){var e=n.indexOf(".mp4");return{$orig:o.__get_orig(n),g0:e}}));o._isMounted||(o.e0=function(n){o.activeTab=1}),o.$mp.data=Object.assign({},{$root:{l0:t}})},a=[];t.d(n,"a",function(){return e}),t.d(n,"b",function(){return a})},d62c:function(o,n,t){},de63:function(o,n,t){"use strict";(function(o){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=function(){return t.e("components/uni-swiper-dot/uni-swiper-dot").then(t.bind(null,"3572"))},a=function(){return t.e("components/uni-badge/uni-badge").then(t.bind(null,"3b98"))},i=function(){return t.e("components/uni-popup/uni-popup").then(t.bind(null,"0dcd"))},s=function(){return t.e("components/uni-number-box/uni-number-box").then(t.bind(null,"c0f1"))},d={components:{uniSwiperDot:e,uniBadge:a,uniPopup:i,uniNumberBox:s},data:function(){return{goodInfo:{},modelInfo:[],current:0,d_current:0,bagCount:this.$store.state.orderCarList.length||0,buyCount:1,isShowModel:!1,cur_handle:-1,activeTab:1,TjData:[]}},onLoad:function(o){console.log("onLoad=",o),this.modelInfo=JSON.parse(decodeURIComponent(o.modelInfo));var n=JSON.parse(decodeURIComponent(o.goodInfo));console.log("onLoad modelInfo, goodInfo=",this.modelInfo,n),this.goodInfo=n,this.initPage()},onShow:function(){var n=this;o.$on("updateBag",function(o){n.bagCount=n.$store.state.orderCarList.length||0})},methods:{initPage:function(){this.goodInfo.img_list_Arr=this.goodInfo.img_list.split(","),this.goodInfo.goods_img_Arr=this.goodInfo.goods_img.split(","),this.current=0,this.d_current=0},change:function(o){this.current=o.detail.current},change_d:function(o){console.log("chage d =",o),this.d_current=o.detail.current},changeNum:function(o){o<1||(this.flag=o>=this.buyCount?1:2,this.buyCount=o)},GoHome:function(){o.reLaunch({url:"/pages/tabBar/component/component"})},GoBag:function(){o.navigateTo({url:"/pages/component/audio/shopBag/shopBag"})},radioChange:function(o){for(var n=0;n<this.modelInfo.length;n++)if(this.modelInfo[n].goods_model===o.target.value){this.current=n;break}},closePopup:function(){this.isShowModel=!1},openModel:function(o){console.log("openModel"),this.isShowModel=!0,this.cur_handle=o,this.buyCount=1,this.$refs.numBox.set},videoErrorCallback:function(){o.showToast({title:"视频加载出错！",icon:"none",duration:2e3})},addBag:function(){var n=this;if(1==this.cur_handle){var t=this.goodInfo;return t.goods_model=this.modelInfo[this.current].goods_model,t.goods_num=this.buyCount,t.flag=1,o.showLoading({title:"支付中..."}),void this.$store.dispatch("payGood",t).then(function(o){console.log("立即购买 成功=",o),n.wxPayData=o,n.GoWXPay()}).catch(function(n){console.log("立即购买 失败=",n),o.hideLoading()})}if(console.log("cur_handle=",this.cur_handle),Number(this.buyCount)>Number(this.goodInfo.good_stock))o.showToast({title:"您购买数量超过库存！",icon:"none",duration:2e3});else{o.showLoading({title:"添加中"});var e={goods_no:this.goodInfo.goods_no,goods_model:this.modelInfo[this.current].goods_model,goods_num:this.buyCount,goods_name:this.goodInfo.goods_name,openid:this.$store.state.sysOpenid,goods_price:this.goodInfo.goods_price,flag:this.flag};this.$store.dispatch("addBag",e).then(function(t){t.code,n.closePopup(),o.hideLoading(),1==n.cur_handle&&n.GoBag()}).catch(function(o){})}},getGoodDetailInfo:function(n){var t=this;this.activeTab=1;var e=this.$store.state.host_url;o.request({url:e+"/pay/queryGoodsInfos",data:{goods_no:n},method:"GET",header:{"content-type":"application/x-www-form-urlencoded"},success:function(n){console.log("queryGoodsInfos=",n.data),"0000"==n.data.code?(t.modelInfo=n.data.modelList,t.goodInfo=n.data.goodinfo,t.initPage()):o.showToast({title:"加载商品详细信息失败！",icon:"none",duration:2e3})}})},getTjGoods:function(){var n=this;this.activeTab=2;var t=this.$store.state.host_url;o.request({url:t+"/pay/queryTjGoodInfos",data:{goods_no:this.goodInfo.goods_no,good_type:this.goodInfo.good_type},method:"GET",header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){if(console.log("queryTjGoodInfos=",t.data),"0000"==t.data.code){var e=t.data.goodinfos;n.TjData=[];for(var a=0;a<e.length;){var i=[];i.push(e[a]),e[a+1]&&i.push(e[a+1]),n.TjData.push(i),a+=2}console.log("TjData=",n.TjData)}else o.showToast({title:"获取推荐失败！",icon:"none",duration:2e3})}})},GoWXPay:function(){var n=this;o.requestPayment({provider:"wxpay",timeStamp:this.wxPayData.timeStamp,nonceStr:this.wxPayData.nonceStr,package:"prepay_id="+this.wxPayData.prepay_id,signType:this.wxPayData.signType,paySign:this.wxPayData.paySign,success:function(t){o.hideLoading(),console.log("GoWXPay success:"+JSON.stringify(t));var e="/pages/component/audio/shopBag/PayPage/PayPage?payCode=";o.redirectTo({url:e+0+"&msg="+t.errMsg}),n.$store.dispatch("getBagList")},fail:function(t){console.log("GoWXPay fail:"+JSON.stringify(t)),o.hideLoading();var e="/pages/component/audio/shopBag/PayPage/PayPage?payCode=";o.redirectTo({url:e+1+"&msg="+t.errMsg}),n.$store.dispatch("updateStock",n.wxPayData.order_no)}})}}};n.default=d}).call(this,t("543d")["default"])},ed75:function(o,n,t){"use strict";t.r(n);var e=t("de63"),a=t.n(e);for(var i in e)"default"!==i&&function(o){t.d(n,o,function(){return e[o]})}(i);n["default"]=a.a},f783:function(o,n,t){"use strict";var e=t("d62c"),a=t.n(e);a.a}},[["adcc","common/runtime","common/vendor"]]]);